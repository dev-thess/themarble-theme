<div class="product-cart-action">
  {% if product.available %}
  {% if settings.product_cart_type == 'ajax_spin_cart' %}
  <button type="submit" class="ajax-spin-cart cart-button" id="AddToCart">
    <span>
      <span class="cart-title" id="AddToCartText">{{ settings.cart_button_title }}</span>
      <span style="margin: 0 5px;">|</span>
      <span class="cart-price-display" id="CartPriceDisplay">{{ current_variant.price | money }}</span>
      <span class="cart-loading">{{ settings.wait_title }}</span>
      <span class="cart-added">{{ settings.added_title }}</span>
      <span class="cart-unavailable">{{ settings.unavailable_title }}</span>
    </span>
  </button>
  {% elsif settings.product_cart_type == 'ajax_popup_cart' or settings.product_cart_type == 'without_ajax_cart' %}
  <button type="submit" class="button cart-button" id="AddToCart">
    <span>
      {% if current_variant.inventory_policy == "continue" and current_variant.inventory_quantity <= 0 %}
      <span class="cart-title" id="AddToCartText">{{ settings.preorder_button_title }}</span>
      {%- else -%}
      <span class="cart-title" id="AddToCartText">{{ settings.cart_button_title }}</span>
      {%- endif -%}
      <span style="margin: 0 5px;">â€¢</span>
      <span class="cart-price-display" id="CartPriceDisplay">{{ current_variant.price | money }}</span>
    </span>
  </button>
  {% endif %}
  <!-- Guaranteed safe checkout -->
  <div style="text-align: center; margin-top: 4px; font-size: 14px; color: #666;">
    Guaranteed safe checkout
  </div>
  {% unless settings.product_cart_type == 'without_ajax_cart' %}
  <script>
    jQuery('#AddToCart').click(function(e) {
      e.preventDefault();
      Shopify.addItemFromFormStart('AddToCartForm', {{ product.id }});
    }); 
  </script>
  {% endunless %}
  {% else %}
  <button class="cart-disable" type="button" style="background-color: #aaaaaa; color: white; padding: 12px 20px; border: none; height: 45px; min-width: 200px;">
    <span class="cart-text">{{ settings.out_of_stock }}</span>
  </button>
  {% endif %}
</div>

<script>
  // Update the cart price based on quantity and variant
  function updateCartPrice() {
    var quantity = parseInt(document.getElementById('qty-input').value) || 1;
    var variantPrice = {{ current_variant.price }};
    var totalPrice = quantity * variantPrice;
    
    // Update price in cart button
    var cartPriceDisplay = document.getElementById('CartPriceDisplay');
    if (cartPriceDisplay) {
      cartPriceDisplay.innerHTML = Shopify.formatMoney(totalPrice, "{{ shop.money_format }}");
    }
  }
</script>